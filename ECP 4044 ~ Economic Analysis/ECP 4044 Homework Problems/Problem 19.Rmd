---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r}
getValue <- function(n) {
df <- as.data.frame(matrix(data = NA, nrow = n + 1, ncol = 8))
colnames(df) <- c("N", "K", "NK", "PKN", "GoodW", "BadW", "TotalW", "CE")
df$N <- n
df$K <- 0:(nrow(df) - 1)
df$NK <- df$N - df$K
df$PKN <- (factorial(df$N) / (factorial(df$K) * factorial(df$NK))) *
  (.05^df$K) * (.95^df$NK)
df$GoodW <- 40000 * df$NK / n
df$BadW <- 10000 * df$K / n
df$TotalW <- df$GoodW + df$BadW
df$CE <- df$PKN * sqrt(df$TotalW)
return(((sum(df$CE)^2) - 38025)*5)
}

df2 <- as.data.frame(matrix(data = NA, nrow = 71, ncol = 2))
colnames(df2) <- c("N", "Value")
df2$N <- 100:170
df2$Value <- sapply(df2$N, getValue)
df2

library(tidyverse)
df2 %>%
  ggplot(aes(x = N, y = Value)) +
  geom_point() +
  geom_smooth(formula = y ~ sqrt(x))
```

